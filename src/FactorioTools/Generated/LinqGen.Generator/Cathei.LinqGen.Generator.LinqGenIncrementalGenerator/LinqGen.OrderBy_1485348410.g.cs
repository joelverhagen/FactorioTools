// DO NOT EDIT
// Generated by LinqGen.Generator
#nullable disable
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Runtime.CompilerServices;
using Cathei.LinqGen;
using Cathei.LinqGen.Hidden;

namespace Cathei.LinqGen.Hidden
{
    // Non-exported Enumerable should consider anonymous type, thus it will be internal
    internal struct OrderBy_QyMWc1 : IInternalOrderedStub<global::Knapcode.FactorioTools.OilField.Location>
    {
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        internal OrderBy_QyMWc1(in Gen_FT9VU3 source, global::System.Func<global::Knapcode.FactorioTools.OilField.Location, int> selector_QyMWc1) : this()
        {
            this.source_FT9VU3 = source.source_FT9VU3;
            this.selector_QyMWc1 = selector_QyMWc1;
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public ThenBy_wHlUy ThenBy(global::System.Func<global::Knapcode.FactorioTools.OilField.Location, int> selector_wHlUy) => new ThenBy_wHlUy(this, selector_wHlUy);
        internal struct Sorter : IComparer<int>, IDisposable
        {
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            public Sorter(PooledListNative<global::Knapcode.FactorioTools.OilField.Location> elements, global::System.Func<global::Knapcode.FactorioTools.OilField.Location, int> selector_QyMWc1)
            {
                this.comparer_QyMWc1 = default;
                keys_QyMWc1 = new PooledListNative<int>(elements.Count);
                for (int i = 0; i < elements.Count; ++i)
                    keys_QyMWc1.Add(selector_QyMWc1.Invoke(elements[i]));
            }

            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            public int Compare(int x, int y)
            {
                int result;
                result = comparer_QyMWc1.Compare(keys_QyMWc1[x], keys_QyMWc1[y]);
                if (result != 0)
                    return result;
                return x - y;
            }

            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            public void Dispose()
            {
                keys_QyMWc1.Dispose();
            }

            public void PartialQuickSort(DynamicArrayNative<int> indexesToSort, int left, int right, int min, int max)
            {
                do
                {
                    int mid = PartitionHoare(indexesToSort, left, right);
                    if (left < mid && mid >= min)
                        PartialQuickSort(indexesToSort, left, mid, min, max);
                    left = mid + 1;
                }
                while (left < right && left <= max);
            }

            // Hoare partition scheme
            // This implementation is faster when using struct comparer (more comparison and less copy)
            private int PartitionHoare(DynamicArrayNative<int> indexesToSort, int left, int right)
            {
                // preventing overflow of the pivot
                int pivot = left + ((right - left) >> 1);
                int pivotIndex = indexesToSort[pivot];
                int i = left - 1;
                int j = right + 1;
                while (true)
                {
                    // Move the left index to the right at least once and while the element at
                    // the left index is less than the pivot
                    while (Compare(indexesToSort[++i], pivotIndex) < 0)
                        ;
                    // Move the right index to the left at least once and while the element at
                    // the right index is greater than the pivot
                    while (Compare(indexesToSort[--j], pivotIndex) > 0)
                        ;
                    // If the indices crossed, return
                    if (i >= j)
                        return j;
                    // Swap the elements at the left and right indices
                    (indexesToSort[i], indexesToSort[j]) = (indexesToSort[j], indexesToSort[i]);
                }
            }

            private ValueCompareToComparer<int> comparer_QyMWc1;
            private PooledListNative<int> keys_QyMWc1;
        }

        [EditorBrowsable(EditorBrowsableState.Never)]
        internal global::System.Collections.Generic.IEnumerable<global::Knapcode.FactorioTools.OilField.Location> source_FT9VU3;
        [EditorBrowsable(EditorBrowsableState.Never)]
        internal global::System.Func<global::Knapcode.FactorioTools.OilField.Location, int> selector_QyMWc1;
    }
}

namespace Cathei.LinqGen
{
}